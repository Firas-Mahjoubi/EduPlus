{% extends 'base.html.twig' %}

{% block title %}Clubs{% endblock %}

{% block body %}
    <div style="padding: 20px; font-family: Arial, sans-serif;">
        <h1 style="font-size: 24px; margin-bottom: 20px;">Clubs</h1>

        <!-- Search Form -->
        <form action="{{ path('club_list') }}" method="get" style="margin-bottom: 20px;">
            <input 
                type="text" 
                name="search" 
                value="{{ app.request.query.get('search') }}" 
                placeholder="Search for clubs..." 
                style="padding: 5px; width: 300px; margin-right: 10px; font-size: 14px;">
            <button 
                type="submit" 
                style="padding: 5px 10px; font-size: 14px; background-color: #007bff; color: #fff; border: none; cursor: pointer;">
                Search
            </button>
        </form>

        <!-- Club Listings -->
        <div style="display: flex; flex-wrap: wrap; gap: 20px;">
            {% for club in clubs %}
                <div style="border: 1px solid #ddd; border-radius: 5px; padding: 15px; width: 300px;">
                    <!-- Club Information -->
                    <div style="display: flex; align-items: center; margin-bottom: 10px;">
                        <img 
                            src="{{ asset('uploads/logos/' ~ club.logo) }}" 
                            alt="{{ club.nom }}" 
                            style="width: 50px; height: 50px; border-radius: 5px; margin-right: 10px;">
                        <div>
                            <h4 style="margin: 0; font-size: 18px; color: #007bff;">{{ club.nom }}</h4>
                            <small style="color: #555;">{{ club.description }}</small>
                        </div>
                    </div>

                    <!-- Average Rating -->
                    <div>
                        Average Rating:
                        {% if club.rating|length > 0 %}
                            {% set total = 0 %}
                            {% for rating in club.rating %}
                                {% set total = total + rating.value %}
                            {% endfor %}
                            <span data-coreui-precision="0.25" data-coreui-toggle="rating" data-coreui-value">{{ (total / club.rating|length)}}</span>
                        {% else %}
                            <span style="color: #aaa;">No ratings yet</span>
                        {% endif %}
                    </div>

                    <!-- Description -->
                    <p style="margin: 15px 0; color: #333; font-size: 14px;">
                        {{ club.description|length > 100 ? club.description|slice(0, 100) ~ '...' : club.description }}
                    </p>

                    <!-- Join Button -->
                    <div style="text-align: center;">
                        <a 
                            href="{{ path('club_details', {'id': club.id}) }}" 
                            style="padding: 5px 10px; font-size: 14px; background-color: #007bff; color: #fff; text-decoration: none; border-radius: 5px;">
                            Join {{ club.nom }}
                        </a>
                    </div>
                </div>
            {% else %}
                <div style="text-align: center; color: #888; font-size: 14px;">
                    No clubs found.
                </div>
            {% endfor %}
        </div>
    </div>
{% endblock %}
